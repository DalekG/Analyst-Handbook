<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Abnormal Account Login Activity – Analyst Handbook</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

  <main>

    <header>
      <h1>Abnormal Account Login Activity</h1>
    </header>

    <section id="overview">
      <h2>Overview</h2>
      <p>
        This use case focuses on detecting and investigating abnormal authentication behavior,
        specifically an unusual volume of failed login attempts against one or more user accounts.
        These events may indicate brute-force attacks, password spraying, credential stuffing,
        or misconfigured applications.
      </p>
    </section>

    <section id="attack-description">
      <h2>Attack Description</h2>
      <p>
        Adversaries commonly attempt to gain initial access by abusing authentication mechanisms.
        This activity often manifests as repeated failed login attempts targeting individual
        accounts or many accounts in quick succession.
      </p>
      <ul>
        <li>Brute-force attempts against a single account</li>
        <li>Password spraying across many accounts using one or few passwords</li>
        <li>Credential stuffing using leaked username/password combinations</li>
        <li>Automated tooling generating high-volume authentication failures</li>
      </ul>
    </section>

    <section id="what-to-look-for">
      <h2>What to Look For</h2>
      <ul>
        <li>3 or more failed authentication events within a short time window</li>
        <li>Multiple user accounts targeted from a single source IP</li>
        <li>Authentication failures followed by a successful login</li>
        <li>Unusual geolocation or ASN for the user account</li>
        <li>Repeated failures against high-value or privileged accounts</li>
      </ul>
    </section>

    <section id="workflow">
      <h2>Investigation Workflow</h2>

      <h3>Abnormal Amount of Failed Logins</h3>

      <h4>Identify the Targeted Account(s)</h4>
      <ul>
        <li>
          <strong>Single account targeted</strong>
          <ul>
            <li>Determine if the account is high-value (administrator, service account, executive)</li>
            <li>Review recent successful logins for the account</li>
            <li>Verify account status (active, disabled, locked)</li>
          </ul>
        </li>
        <li>
          <strong>Multiple accounts targeted</strong>
          <ul>
            <li>Identify patterns (sequential usernames, alphabetical ordering, random selection)</li>
            <li>Assess for password spray indicators</li>
            <li>List all targeted accounts for continued monitoring</li>
          </ul>
        </li>
      </ul>

      <h4>Identify the Source</h4>
      <ul>
        <li>
          <strong>Internal source</strong>
          <ul>
            <li>Verify legitimacy of the source system</li>
            <li>Check for signs of compromised credentials or malware on the source</li>
            <li>Interview the user if applicable</li>
          </ul>
        </li>
        <li>
          <strong>External source</strong>
          <ul>
            <li>Check threat intelligence for known malicious IPs or infrastructure</li>
            <li>Review geolocation and ASN of the source</li>
            <li>Identify use of VPNs, proxies, or anonymization services</li>
          </ul>
        </li>
      </ul>

      <h4>Was the Attack Successful?</h4>
      <ul>
        <li>
          <strong>Yes</strong>
          <ul>
            <li>Immediately escalate to Incident Response</li>
            <li>Initiate account compromise workflow</li>
            <li>Consider disabling or resetting the affected account(s)</li>
            <li>Review all activity from the successful login forward</li>
          </ul>
        </li>
        <li>
          <strong>No</strong>
          <ul>
            <li>Document failed attempt count and timeframe</li>
            <li>Determine whether account lockout occurred</li>
            <li>Continue monitoring for 24–48 hours</li>
          </ul>
        </li>
      </ul>

      <h4>Is This Expected Behavior?</h4>
      <ul>
        <li>
          <strong>Yes</strong>
          <ul>
            <li>Document the reason for the false positive (forgotten password, misconfiguration)</li>
            <li>Adjust alert thresholds if appropriate</li>
            <li>Close the alert</li>
          </ul>
        </li>
        <li>
          <strong>No</strong>
          <ul>
            <li>Request senior analyst review</li>
            <li>Escalate if thresholds are exceeded or behavior is concerning</li>
          </ul>
        </li>
      </ul>

    </section>

    <section id="tools-queries">
      <h2>Tools & Queries</h2>
      <ul>
        <li>Elastic</li>
          <li>user.name : joe.duffy and event.code : 4624</li>
        <li>Elastic Discover for authentication event analysis</li>
        <li>Threat intelligence platforms (IP reputation, ASN lookup)</li>
        <li>Identity provider logs (AD, Azure AD, Okta, etc.)</li>
      </ul>
    </section>

    <section id="response-workflow">
      <h2>Response Workflow</h2>
      <ul>
        <li>Notify Incident Response for confirmed compromise</li>
        <li>Disable or reset compromised accounts</li>
        <li>Force password resets where appropriate</li>
        <li>Implement temporary IP blocks or conditional access controls</li>
        <li>Document findings and actions taken</li>
      </ul>
    </section>

    <section id="references">
      <h2>References</h2>
      <ul>
        <li>MITRE ATT&CK: Credential Access & Initial Access techniques</li>
        <li>NIST SP 800-53 – Identification and Authentication</li>
        <li>Internal SOC Playbooks and IR Procedures</li>
      </ul>
    </section>

  </main>

</body>
</html>
