<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Credential Dumping – Analyst Handbook</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

  <main>

    <header>
      <h1>Credential Dumping</h1>
    </header>

    <section id="overview">
      <h2>Overview</h2>
      <p>
        Credential dumping is the process of obtaining account login and password information, typically
        in the form of cleartext passwords or hashes, from an operating system or software. This is a
        critical phase of an attack that allows for lateral movement and privilege escalation.
      </p>
    </section>

    <section id="attack-description">
      <h2>Attack Description</h2>
      <p>
        Adversaries target credential stores to gain higher levels of access. Common targets include
        memory (LSASS), local databases (SAM), and domain-wide databases (NTDS.dit). Success in this
        phase often leads to a "complete compromise" of the identity perimeter.
      </p>
    </section>

    <section id="workflow">
      <h2>Investigation Workflow</h2>

      <h3>Identify Dumping Method</h3>
      <h4>What technique was used?</h4>
      <ul>
        <li><strong>LSASS Memory Dump:</strong> Check for Mimikatz, ProcDump, or Task Manager usage.</li>
        <li><strong>SAM Database Access:</strong> Review registry export logs or volume shadow copy access.</li>
        <li><strong>DCSync:</strong> Check Domain Controller logs for <code>Replicating Directory Changes</code> (Event ID 4662).</li>
        <li><strong>Kerberoasting:</strong> Review service ticket requests (RC4 encryption) for service accounts.</li>
        <li><strong>NTDS.dit Extraction:</strong> <strong>CRITICAL</strong> - Indicates attempt at full domain compromise.</li>
      </ul>

      <h3>Identify Affected System and Scope</h3>
      <h4>Type of System:</h4>
      <ul>
        <li><strong>Domain Controller:</strong> <strong>CRITICAL</strong> - Assume full domain compromise immediately.</li>
        <li><strong>Server:</strong> High concern; check for presence of logged-in privileged accounts.</li>
        <li><strong>Workstation:</strong> Concern; identify which users have cached credentials on the host.</li>
      </ul>

      <h4>What credentials were potentially exposed?</h4>
      <ul>
        <li><strong>Domain Admin:</strong> Critical escalation; highest priority.</li>
        <li><strong>Local Admin:</strong> Serious concern; potential for local lateral movement.</li>
        <li><strong>Service Accounts:</strong> Check for high privileges or access to sensitive databases.</li>
        <li><strong>Standard Users:</strong> Lower immediate risk, but still requires remediation.</li>
      </ul>

      <h3>Identify the Actor</h3>
      <h4>Process that performed the dump:</h4>
      <ul>
        <li><strong>Known Tool (Mimikatz, Task Manager):</strong> Clear indicator of a direct attack.</li>
        <li><strong>System Process:</strong> Check for process injection or hollowing (e.g., <code>lsass.exe</code> behavior).</li>
        <li><strong>Unknown Binary:</strong> Research the hash and identify the installation vector.</li>
      </ul>

      <h4>User Context:</h4>
      <ul>
        <li><strong>Admin Account:</strong> Verify if this was a legitimate (though risky) admin troubleshooting action.</li>
        <li><strong>Standard User:</strong> Indicates a successful privilege escalation is in progress.</li>
        <li><strong>SYSTEM Account:</strong> Likely automated malware or advanced persistent threat activity.</li>
      </ul>

      <h3>Status of the Attack</h3>
      <ul>
        <li>
          <strong>Attack Ongoing:</strong>
          <ul>
            <li><strong>Isolate the system immediately</strong> from the network.</li>
            <li>Terminate malicious processes identified in the process tree.</li>
            <li><strong>Do not shut down</strong> the system (preserve volatile memory for forensics).</li>
          </ul>
        </li>
        <li>
          <strong>Attack Completed:</strong>
          <ul>
            <li>Assume all credentials on that host are now in the hands of the adversary.</li>
            <li>Proceed immediately to Response Workflow.</li>
          </ul>
        </li>
      </ul>

      <h3>Execute Immediate Response</h3>
      <ul>
        <li>Reset all potentially compromised credentials immediately.</li>
        <li>Force logoff of all active sessions using affected accounts.</li>
        <li>Review all activity performed by the compromised accounts since the dump time.</li>
        <li>Check for lateral movement (e.g., Event ID 4624) originating from the affected system.</li>
        <li><strong>Escalate to IR immediately.</strong></li>
        <li>If a DC was compromised, consider a domain-wide password reset (KRBTGT reset).</li>
        <li>Enable enhanced monitoring/logging across all Tier-0 and Tier-1 systems.</li>
        <li>Hunt for the use of dumped credentials/hashes elsewhere in the environment.</li>
      </ul>

    </section>

    <section id="tools-queries">
      <h2>Tools &amp; Queries</h2>
      <ul>
        <li>EDR Alerts (Credential Access category)</li>
        <li>SIEM Search: <code>EventCode=4662</code> (DCSync) or <code>EventCode=4656</code> (Handle to LSASS)</li>
        <li>YARA scans for Mimikatz strings in memory</li>
        <li>BloodHound (to visualize potential paths the attacker might take next)</li>
      </ul>
    </section>

    <section id="response-workflow">
      <h2>Response Workflow</h2>
      <ul>
        <li>Isolate the primary "patient zero" host.</li>
        <li>Invalidate all Kerberos tickets (TGT/TGS) for exposed accounts.</li>
        <li>Perform a credential sweep: Change passwords for all accounts logged into the host in the last 24h.</li>
        <li>Identify and close the vulnerability that allowed the initial access.</li>
      </ul>
    </section>

    <section id="references">
      <h2>References</h2>
      <ul>
        <li>MITRE ATT&CK – T1003 (OS Credential Dumping)</li>
        <li>MITRE ATT&CK – T1558 (Steal or Forge Kerberos Tickets)</li>
        <li>Microsoft Security – Securing Privileged Access</li>
        <li>NSA - Detecting Mimikatz Use</li>
      </ul>
    </section>

  </main>

</body>
</html>
